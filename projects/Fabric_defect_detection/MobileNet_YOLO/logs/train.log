2021-03-18 10:57:07,636 - train.py[line:438] - INFO: start train YOLOv3, train params:{'data_dir': 'E:\\Projects\\Fabric_Defect_Detection\\model_dev\\v1.2.0\\dataset\\train', 'val_dir': 'E:\\Projects\\Fabric_Defect_Detection\\model_dev\\v1.2.0\\dataset\\valid', 'train_list': 'train.txt', 'eval_list': 'valid.txt', 'use_filter': False, 'class_dim': 2, 'label_dict': {'defect': 0, 'striation': 1}, 'num_dict': {0: 'defect', 1: 'striation'}, 'image_count': 1551, 'continue_train': True, 'pretrained': False, 'pretrained_model_dir': 'E:\\Projects\\Fabric_Defect_Detection\\model_dev\\v1.2.0\\pretrained_model', 'save_model_dir': 'E:\\Projects\\Fabric_Defect_Detection\\model_dev\\v1.2.0\\saved_model', 'model_prefix': 'yolo-v3', 'freeze_dir': 'E:\\Projects\\Fabric_Defect_Detection\\model_dev\\v1.2.0\\freeze_model', 'use_tiny': False, 'max_box_num': 10, 'num_epochs': 100, 'train_batch_size': 16, 'use_gpu': True, 'yolo_cfg': {'input_size': [3, 352, 352], 'anchors': [260, 16, 346, 18, 14, 349], 'anchor_mask': [[0, 1, 2]]}, 'yolo_tiny_cfg': {'input_size': [3, 352, 352], 'anchors': [96, 15, 157, 15, 240, 16, 303, 17, 351, 16, 351, 26], 'anchor_mask': [[3, 4, 5], [0, 1, 2]]}, 'ignore_thresh': 0.7, 'mean_rgb': [127.5, 127.5, 127.5], 'mode': 'train', 'multi_data_reader_count': 4, 'apply_distort': True, 'nms_top_k': 10, 'nms_pos_k': 10, 'valid_thresh': 0.005, 'nms_thresh': 0.1, 'image_distort_strategy': {'expand_prob': 0.5, 'expand_max_ratio': 1.25, 'hue_prob': 0.5, 'hue_delta': 18, 'contrast_prob': 0.5, 'contrast_delta': 0.3, 'saturation_prob': 0.5, 'saturation_delta': 0.5, 'brightness_prob': 0.5, 'brightness_delta': 0.6}, 'sgd_strategy': {'learning_rate': 0.002, 'lr_epochs': [10, 45, 80, 110, 135, 160, 180], 'lr_decay': [1, 0.5, 0.25, 0.1, 0.025, 0.004, 0.001, 0.0005]}, 'early_stop': {'sample_frequency': 50, 'rise_limit': 10, 'min_loss': 5e-08, 'min_curr_map': 0.84}}
2021-03-18 10:57:07,636 - train.py[line:440] - INFO: create place, use gpu:True
2021-03-18 10:57:07,638 - train.py[line:443] - INFO: build network and program
2021-03-18 10:57:09,889 - train.py[line:457] - INFO: build executor and init params
2021-03-18 10:57:11,898 - train.py[line:418] - INFO: load param from retrain model
2021-03-18 10:57:12,759 - train.py[line:477] - INFO: current pass: 0, start read image
2021-03-18 10:58:56,520 - train.py[line:494] - INFO: pass 0 train result, current pass mean loss: 11.84730038200457
2021-03-18 10:59:07,948 - train.py[line:500] - INFO: 0 epoch current pass map is 0.8941843509674072, accum_map is 0.8941843509674072
2021-03-18 10:59:07,948 - train.py[line:506] - INFO: model save 0 epcho train result, current best pass MAP 0.8941843509674072
2021-03-18 10:59:10,766 - train.py[line:512] - INFO: best pass 0 current best pass MAP is 0.8941843509674072
2021-03-18 10:59:10,766 - train.py[line:477] - INFO: current pass: 1, start read image
2021-03-18 11:00:31,281 - train.py[line:494] - INFO: pass 1 train result, current pass mean loss: 9.770564300497783
2021-03-18 11:00:31,281 - train.py[line:477] - INFO: current pass: 2, start read image
2021-03-18 11:01:51,014 - train.py[line:494] - INFO: pass 2 train result, current pass mean loss: 9.546648644909416
2021-03-18 11:02:02,449 - train.py[line:500] - INFO: 2 epoch current pass map is 0.9106508493423462, accum_map is 0.8868264555931091
2021-03-18 11:02:02,449 - train.py[line:506] - INFO: model save 2 epcho train result, current best pass MAP 0.9106508493423462
2021-03-18 11:02:05,100 - train.py[line:512] - INFO: best pass 2 current best pass MAP is 0.9106508493423462
2021-03-18 11:02:05,100 - train.py[line:477] - INFO: current pass: 3, start read image
2021-03-18 11:03:25,179 - train.py[line:494] - INFO: pass 3 train result, current pass mean loss: 9.433589345401096
2021-03-18 11:03:25,181 - train.py[line:477] - INFO: current pass: 4, start read image
2021-03-18 11:04:45,580 - train.py[line:494] - INFO: pass 4 train result, current pass mean loss: 9.401349741159025
2021-03-18 11:04:56,963 - train.py[line:500] - INFO: 4 epoch current pass map is 0.9243696928024292, accum_map is 0.8994236588478088
2021-03-18 11:04:56,963 - train.py[line:506] - INFO: model save 4 epcho train result, current best pass MAP 0.9243696928024292
2021-03-18 11:04:59,599 - train.py[line:512] - INFO: best pass 4 current best pass MAP is 0.9243696928024292
2021-03-18 11:04:59,599 - train.py[line:477] - INFO: current pass: 5, start read image
2021-03-18 11:06:19,913 - train.py[line:494] - INFO: pass 5 train result, current pass mean loss: 9.277507806561657
2021-03-18 11:06:19,913 - train.py[line:477] - INFO: current pass: 6, start read image
2021-03-18 11:07:40,326 - train.py[line:494] - INFO: pass 6 train result, current pass mean loss: 9.41887837832736
2021-03-18 11:07:51,751 - train.py[line:500] - INFO: 6 epoch current pass map is 0.9395321607589722, accum_map is 0.9102370142936707
2021-03-18 11:07:51,751 - train.py[line:506] - INFO: model save 6 epcho train result, current best pass MAP 0.9395321607589722
2021-03-18 11:07:54,791 - train.py[line:512] - INFO: best pass 6 current best pass MAP is 0.9395321607589722
2021-03-18 11:07:54,791 - train.py[line:477] - INFO: current pass: 7, start read image
2021-03-18 11:09:15,825 - train.py[line:494] - INFO: pass 7 train result, current pass mean loss: 9.135615879727393
2021-03-18 11:09:15,825 - train.py[line:477] - INFO: current pass: 8, start read image
2021-03-18 11:10:38,019 - train.py[line:494] - INFO: pass 8 train result, current pass mean loss: 9.087469661358705
2021-03-18 11:10:49,486 - train.py[line:500] - INFO: 8 epoch current pass map is 0.9332771301269531, accum_map is 0.9142754077911377
2021-03-18 11:10:49,486 - train.py[line:512] - INFO: best pass 6 current best pass MAP is 0.9395321607589722
2021-03-18 11:10:49,486 - train.py[line:477] - INFO: current pass: 9, start read image
2021-03-18 11:12:09,295 - train.py[line:494] - INFO: pass 9 train result, current pass mean loss: 9.100953834573017
2021-03-18 11:12:09,295 - train.py[line:477] - INFO: current pass: 10, start read image
2021-03-18 11:13:29,479 - train.py[line:494] - INFO: pass 10 train result, current pass mean loss: 8.974566666121335
2021-03-18 11:13:41,146 - train.py[line:500] - INFO: 10 epoch current pass map is 0.9347936511039734, accum_map is 0.916217029094696
2021-03-18 11:13:41,146 - train.py[line:512] - INFO: best pass 6 current best pass MAP is 0.9395321607589722
2021-03-18 11:13:41,146 - train.py[line:477] - INFO: current pass: 11, start read image
2021-03-18 11:15:01,296 - train.py[line:494] - INFO: pass 11 train result, current pass mean loss: 8.888661423909296
2021-03-18 11:15:01,296 - train.py[line:477] - INFO: current pass: 12, start read image
2021-03-18 11:16:22,935 - train.py[line:494] - INFO: pass 12 train result, current pass mean loss: 8.801758731763387
2021-03-18 11:16:34,539 - train.py[line:500] - INFO: 12 epoch current pass map is 0.9413083791732788, accum_map is 0.9191375970840454
2021-03-18 11:16:34,541 - train.py[line:506] - INFO: model save 12 epcho train result, current best pass MAP 0.9413083791732788
2021-03-18 11:16:37,257 - train.py[line:512] - INFO: best pass 12 current best pass MAP is 0.9413083791732788
2021-03-18 11:16:37,257 - train.py[line:477] - INFO: current pass: 13, start read image
2021-03-18 11:17:58,705 - train.py[line:494] - INFO: pass 13 train result, current pass mean loss: 8.797636612174438
2021-03-18 11:17:58,705 - train.py[line:477] - INFO: current pass: 14, start read image
2021-03-18 11:19:19,053 - train.py[line:494] - INFO: pass 14 train result, current pass mean loss: 8.785919764607224
2021-03-18 11:19:30,530 - train.py[line:500] - INFO: 14 epoch current pass map is 0.9410567283630371, accum_map is 0.9214590787887573
2021-03-18 11:19:30,530 - train.py[line:512] - INFO: best pass 12 current best pass MAP is 0.9413083791732788
2021-03-18 11:19:30,530 - train.py[line:477] - INFO: current pass: 15, start read image
2021-03-18 11:20:51,488 - train.py[line:494] - INFO: pass 15 train result, current pass mean loss: 8.861105043863512
2021-03-18 11:20:51,488 - train.py[line:477] - INFO: current pass: 16, start read image
2021-03-18 11:22:13,282 - train.py[line:494] - INFO: pass 16 train result, current pass mean loss: 8.654001712799072
2021-03-18 11:22:25,083 - train.py[line:500] - INFO: 16 epoch current pass map is 0.9272196292877197, accum_map is 0.9211251735687256
2021-03-18 11:22:25,085 - train.py[line:512] - INFO: best pass 12 current best pass MAP is 0.9413083791732788
2021-03-18 11:22:25,085 - train.py[line:477] - INFO: current pass: 17, start read image
2021-03-18 11:23:45,679 - train.py[line:494] - INFO: pass 17 train result, current pass mean loss: 8.64524419528922
2021-03-18 11:23:45,679 - train.py[line:477] - INFO: current pass: 18, start read image
2021-03-18 11:25:07,002 - train.py[line:494] - INFO: pass 18 train result, current pass mean loss: 8.736887086298047
2021-03-18 11:25:18,563 - train.py[line:500] - INFO: 18 epoch current pass map is 0.9468363523483276, accum_map is 0.923992395401001
2021-03-18 11:25:18,563 - train.py[line:506] - INFO: model save 18 epcho train result, current best pass MAP 0.9468363523483276
2021-03-18 11:25:21,244 - train.py[line:512] - INFO: best pass 18 current best pass MAP is 0.9468363523483276
2021-03-18 11:25:21,244 - train.py[line:477] - INFO: current pass: 19, start read image
2021-03-18 11:26:41,728 - train.py[line:494] - INFO: pass 19 train result, current pass mean loss: 8.669932965150814
2021-03-18 11:26:41,728 - train.py[line:477] - INFO: current pass: 20, start read image
2021-03-18 11:28:03,136 - train.py[line:494] - INFO: pass 20 train result, current pass mean loss: 8.532924440718189
2021-03-18 11:28:14,525 - train.py[line:500] - INFO: 20 epoch current pass map is 0.9347579479217529, accum_map is 0.9248455166816711
2021-03-18 11:28:14,525 - train.py[line:512] - INFO: best pass 18 current best pass MAP is 0.9468363523483276
2021-03-18 11:28:14,525 - train.py[line:477] - INFO: current pass: 21, start read image
2021-03-18 11:29:35,697 - train.py[line:494] - INFO: pass 21 train result, current pass mean loss: 8.67400088752668
2021-03-18 11:29:35,697 - train.py[line:477] - INFO: current pass: 22, start read image
2021-03-18 11:30:56,166 - train.py[line:494] - INFO: pass 22 train result, current pass mean loss: 8.53103818106897
2021-03-18 11:31:07,640 - train.py[line:500] - INFO: 22 epoch current pass map is 0.94005286693573, accum_map is 0.9260848760604858
2021-03-18 11:31:07,642 - train.py[line:512] - INFO: best pass 18 current best pass MAP is 0.9468363523483276
2021-03-18 11:31:07,642 - train.py[line:477] - INFO: current pass: 23, start read image
2021-03-18 11:32:29,017 - train.py[line:494] - INFO: pass 23 train result, current pass mean loss: 8.545573962103461
2021-03-18 11:32:29,019 - train.py[line:477] - INFO: current pass: 24, start read image
2021-03-18 11:33:49,374 - train.py[line:494] - INFO: pass 24 train result, current pass mean loss: 8.512523095632337
2021-03-18 11:34:00,780 - train.py[line:500] - INFO: 24 epoch current pass map is 0.9367407560348511, accum_map is 0.9266021847724915
2021-03-18 11:34:00,782 - train.py[line:512] - INFO: best pass 18 current best pass MAP is 0.9468363523483276
2021-03-18 11:34:00,782 - train.py[line:477] - INFO: current pass: 25, start read image
